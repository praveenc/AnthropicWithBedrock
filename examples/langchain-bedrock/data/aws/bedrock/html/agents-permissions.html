<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Permissions to create and manage an agent - Amazon Bedrock</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="agents-permissions" /><meta name="default_state" content="agents-permissions" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/bedrock/latest/userguide/agents-permissions.html" /><meta name="description" content="To use a custom role for agents instead of the one Amazon Bedrock automatically creates, create an IAM role with the prefix AmazonBedrockExecutionRoleForAgents_ and attach the following permissions by following the steps at Creating a role to delegate permissions to an AWS service" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Bedrock" /><meta name="guide" content="User Guide" /><meta name="abstract" content="User Guide for the Amazon Bedrock service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/bedrock/latest/userguide/agents-permissions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/bedrock/latest/userguide/agents-permissions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/bedrock/latest/userguide/agents-permissions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/bedrock/latest/userguide/agents-permissions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/bedrock/latest/userguide/agents-permissions.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/bedrock/latest/userguide/agents-permissions.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/bedrock/latest/userguide/agents-permissions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/bedrock/latest/userguide/agents-permissions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/bedrock/latest/userguide/agents-permissions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/bedrock/latest/userguide/agents-permissions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/bedrock/latest/userguide/agents-permissions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/bedrock/latest/userguide/agents-permissions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/bedrock/latest/userguide/agents-permissions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/bedrock/latest/userguide/agents-permissions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/bedrock/latest/userguide/agents-permissions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/bedrock/latest/userguide/agents-permissions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/bedrock/latest/userguide/agents-permissions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/bedrock/latest/userguide/agents-permissions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/bedrock/latest/userguide/agents-permissions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/bedrock/latest/userguide/agents-permissions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/bedrock/latest/userguide/agents-permissions.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/bedrock/latest/userguide/agents-permissions.html" hreflang="x-default" /><meta name="feedback-folder" content="2d8c2a09-1dac-41bf-9893-c0333d272b2c" /><meta name="feedback-item" content="Bedrock" /><meta name="this_doc_product" content="Amazon Bedrock" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'bedrock'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Permissions to create and manage an agent" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Permissions to create and manage an agent - Amazon Bedrock</title><meta name="pdf" content="/pdfs/bedrock/latest/userguide/bedrock-ug.pdf#agents-permissions" /><meta name="rss" content="bedrock-ug.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?feedback_destination_id=2d8c2a09-1dac-41bf-9893-c0333d272b2c&amp;topic_url=http://docs.aws.amazon.com/en_us/bedrock/latest/userguide/agents-permissions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/bedrock/latest/userguide/agents-permissions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/bedrock/latest/userguide/agents-permissions.html" /><meta name="keywords" content="Amazon Bedrock,bedrock" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Bedrock",
        "item" : "https://docs.aws.amazon.com/bedrock/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/bedrock/latest/userguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Security in Amazon Bedrock",
        "item" : "https://docs.aws.amazon.com/bedrock/latest/userguide/security.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Identity and access management for Amazon Bedrock",
        "item" : "https://docs.aws.amazon.com/bedrock/latest/userguide/security-iam.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Service roles",
        "item" : "https://docs.aws.amazon.com/bedrock/latest/userguide/security-iam-sr.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Permissions to create and manage an agent",
        "item" : "https://docs.aws.amazon.com/bedrock/latest/userguide/security-iam-sr.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/bedrock/latest/userguide/bedrock-ug.pdf#agents-permissions" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/bedrock/index.html">Amazon Bedrock</a><a href="what-is-bedrock.html">User Guide</a></div><div id="page-toc-src"><a href="#agents-permissions-trust">Trust relationship</a><a href="#agents-permissions-access-models">Permissions to access Amazon Bedrock models</a><a href="#agents-permissions-access-action-api">Permissions to access your action group API schemas in Amazon S3</a><a href="#agents-permissions-access-kb">(Optional) Permissions to access your knowledge bases</a><a href="#agents-permissions-lambda">Permissions to access your action group Lambda functions</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="agents-permissions">Permissions to create and manage an agent</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>To use a custom role for agents instead of the one Amazon Bedrock automatically creates, create an IAM role with the prefix <code class="code">AmazonBedrockExecutionRoleForAgents_</code> and attach the following permissions by following the steps at <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html">Creating a role to delegate permissions to an AWS service</a>.</p><div class="itemizedlist">
             
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Trust relationship</p>
            </li><li class="listitem">
               <p>Access to the Amazon Bedrock base models</p>
            </li><li class="listitem">
               <p>Access to the Amazon S3 objects containing the OpenAPI schemas for the action groups in your agents</p>
            </li><li class="listitem">
               <p>(Optional) Permissions for Amazon Bedrock to query knowledge bases that you want to attach to your agents</p>
            </li><li class="listitem">
               <p>(Optional) If you encrypt your agent with a KMS key, permissions to decrypt
                  the key (see <a href="./encryption-agents.html">Encryption of agent resources</a>)</p>
            </li></ul></div><p>Whether you use a custom role or not, you also need to provide permissions for Amazon Bedrock to access the AWS Lambda functions for the action groups in your agents through attaching a resource-based policy to your Lambda functions. For more details, see <a href="#agents-permissions-lambda">Permissions to access your action group Lambda functions</a>.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#agents-permissions-trust">Trust relationship</a></li><li><a href="#agents-permissions-access-models">Permissions to access Amazon Bedrock models</a></li><li><a href="#agents-permissions-access-action-api">Permissions to access your action group API schemas in Amazon S3</a></li><li><a href="#agents-permissions-access-kb">(Optional) Permissions to access your knowledge bases</a></li><li><a href="#agents-permissions-lambda">Permissions to access your action group Lambda functions</a></li></ul></div>
            <h2 id="agents-permissions-trust">Trust relationship</h2>
            
            <p>The following policy allows Amazon Bedrock to assume this role and create and manage agents. The following shows an example policy you can use. You can restrict the scope of the permission by using one or more global condition context keys. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html">AWS global condition context keys.</a> Set the <code class="code">aws:SourceAccount</code> value to your account ID. Use the <code class="code">ArnEquals</code> or <code class="code">ArnLike</code> condition to restrict the scope to specific agents.</p>
            
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>As a best practice for security purposes, replace the <code class="replaceable">*</code> with specific agent IDs after you have created them.</p></div></div>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Allow",
        "Principal": <span>{</span>
            "Service": "bedrock.amazonaws.com"
        },
        "Action": "sts:AssumeRole",
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "aws:SourceAccount": "<code class="replaceable">account-id</code>"
            },
            "ArnLike": <span>{</span>
                "AWS:SourceArn": "arn:aws:bedrock:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:agent/<code class="replaceable">*</code>"
            }
        }
    }]
}</code></pre>
            
          
            <h2 id="agents-permissions-access-models">Permissions to access Amazon Bedrock models</h2>
            
            <p>Attach the following policy to provide permissions for the role to use Amazon Bedrock models for orchestration.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
       "Effect": "Allow",
       "Action": [
        "bedrock:InvokeModel"
       ],
    "Resource": [
            "arn:aws:bedrock:<code class="replaceable">region</code>::foundation-model/anthropic.claude-v2",
            "arn:aws:bedrock:<code class="replaceable">region</code>::foundation-model/anthropic.claude-instant-v1"
        ]
    }]
}</code></pre>
            
          
            <h2 id="agents-permissions-access-action-api">Permissions to access your action group API schemas in Amazon S3</h2>
            
            <p>Attach the following policy to provide permissions for the role to access the Amazon S3 URIs of the API schemas 
               for your agent's action groups. In the <code class="code">Resource</code> field, provide an Amazon S3 object containing the schemas or add 
               the URI of each schema to the list.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Allow",
        "Action": [
            "s3:GetObject"
        ],
        "Resource": [
            "arn:aws:s3:::<code class="replaceable">bucket/path/to/schema</code>"
        ],
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "aws:ResourceAccount": "<code class="replaceable">account-id</code>"
            }
        }
    }]
}</code></pre>
            
          
            <h2 id="agents-permissions-access-kb">(Optional) Permissions to access your knowledge bases</h2>
            
            <p>Attach the following policy to provide permissions for the role to access knowledge bases that you have set up. Replace <code class="replaceable">account-id</code> and <code class="replaceable">knowledge-base-id</code> with the appropriate values.</p>
               
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "bedrock:QueryKnowledgeBase",
                "bedrock:Retrieve",
                "bedrock:RetrieveAndGenerate"
            ],
            "Resource": [
                "arn:aws:bedrock:*:<code class="replaceable">account-id</code>:knowledge-base/<code class="replaceable">knowledge-base-id</code>"
            ]
        }
    ]
}</code></pre>
            
          
            <h2 id="agents-permissions-lambda">Permissions to access your action group Lambda functions</h2>
            
            <p>Attach the following resource-based policy to a Lambda function to provide to access to the Lambda functions for your agent's action groups. Use the <code class="code">Condition</code> field to specify the ARN of the user account and of the agent. For more information, see <a href="https://docs.aws.amazon.com/lambda/latest/dg/access-control-resource-based.html">Using resource-based policies for Lambda</a>.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Sid": "<code class="replaceable">statement-name</code>",
        "Effect": "Allow",
        "Principal": <span>{</span>
            "Service": "bedrock.amazonaws.com"
        },
        "Action": "lambda:InvokeFunction",
        "Resource":  "arn:aws:lambda:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:function:<code class="replaceable">function-name</code>",
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "AWS:SourceAccount": "<code class="replaceable">account-id</code>"
            },
            "ArnLike": <span>{</span>
                "AWS:SourceArn": "arn:aws:bedrock:<code class="replaceable">region</code>:<code class="replaceable">account-id</code>:agent/<code class="replaceable">agent-id</code>"
            }
        }
    }]
}</code></pre>
            
         <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./model-customization-iam-role.html">Permissions to carry out and manage a model customization job</div><div id="next" class="next-link" accesskey="n" href="./kb-permissions.html">Permissions to create and manage a knowledge base</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?feedback_destination_id=2d8c2a09-1dac-41bf-9893-c0333d272b2c&amp;topic_url=https://docs.aws.amazon.com/en_us/bedrock/latest/userguide/agents-permissions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?feedback_destination_id=2d8c2a09-1dac-41bf-9893-c0333d272b2c&amp;topic_url=https://docs.aws.amazon.com/en_us/bedrock/latest/userguide/agents-permissions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>